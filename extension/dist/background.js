chrome.runtime.onMessageExternal.addListener((e,o,t)=>{if(e.type==="SPOTIFY_AUTH_SUCCESS")return chrome.storage.local.set({spotify_access_token:e.token,spotify_token_timestamp:Date.now()},()=>{console.log("Spotify token stored successfully"),t({success:!0})}),!0});chrome.alarms.create("checkToken",{periodInMinutes:30});chrome.alarms.onAlarm.addListener(e=>{e.name==="checkToken"&&refreshAccessToken()});chrome.runtime.onInstalled.addListener(e=>{e.reason==="install"&&chrome.tabs.create({url:"http://127.0.0.1:5173"})});chrome.action.onClicked.addListener(()=>{chrome.action.setBadgeText({text:""})});
