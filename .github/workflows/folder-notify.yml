name: Folder-Specific Discord Notifications

on:
  push:
    paths:
      - 'extension/**'
      - 'webapp/**'

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
        with:
          fetch-depth: 2

      - name: Check for Extension Changes
        id: check_extension
        run: |
          if git diff --name-only HEAD^ HEAD | grep -q "^extension/"; then
            echo "changed=true" >> $GITHUB_OUTPUT
          fi

      - name: Notify Discord (Extension)
        if: steps.check_extension.outputs.changed == 'true'
        uses: tsickert/discord-webhook@v7.0.0
        with:
          webhook-url: ${{ secrets.DISCORD_WEBHOOK_EXTENSION }}
          content: "New push to the **Extension** folder by ${{ github.actor }}!"

      - name: Check for Webapp Changes
        id: check_webapp
        run: |
          if git diff --name-only HEAD^ HEAD | grep -q "^webapp/"; then
            echo "changed=true" >> $GITHUB_OUTPUT
          fi

      - name: Notify Discord (Webapp)
        if: steps.check_webapp.outputs.changed == 'true'
        uses: tsickert/discord-webhook@v7.0.0
        with:
          webhook-url: ${{ secrets.DISCORD_WEBHOOK_WEBAPP }}
          content: "New push to the **Webapp** folder by ${{ github.actor }}!"